import boto3
import pandas as pd
import os

# Replace these with your actual values
local_file_path = "C:/branch/DS/Xperia/your_file.xlsx"  # Update with the actual file name
s3_bucket_name = "your-s3-bucket-name"  # Replace with your S3 bucket name
s3_key = "path/in/bucket/your_file.xlsx"  # Specify the path and name in the S3 bucket

# Load the Excel file as a pandas DataFrame
df = pd.read_excel(local_file_path)

# Save the DataFrame as a temporary CSV file for upload
temp_csv = "/tmp/temp_data.csv"
df.to_csv(temp_csv, index=False)

# Upload the CSV to S3
s3_client = boto3.client('s3')
try:
    s3_client.upload_file(temp_csv, s3_bucket_name, s3_key)
    print("File uploaded successfully!")
except Exception as e:
    print(f"An error occurred: {e}")

# Clean up temporary file
os.remove(temp_csv)

