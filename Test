def descriptive_stats(df):
    # Filter reopenings
    reopenings = df[df['Event_Type'] == 'IP-Level Ticket Reopened']

    # Debugging: Check if any rows are filtered
    print("Number of rows with 'IP-Level Ticket Reopened':", len(reopenings))

    if reopenings.empty:
        print("No rows with 'IP-Level Ticket Reopened' found.")
        return pd.DataFrame()

    # Group by the index (which is 'unique_ip_ticket_id') and calculate statistics
    grouped = reopenings.groupby(reopenings.index)['Reopen_Deltas_int']

    # Calculate statistics
    stats_df = grouped.agg([
        'count',
        'mean',
        'std',
        'median',
        'min',
        'max',
        lambda x: x.quantile(0.25),
        lambda x: x.quantile(0.75),
        lambda x: x.quantile(0.05),
        lambda x: x.quantile(0.95)
    ]).reset_index()

    # Rename columns
    stats_df.columns = [
        'unique_ip_ticket_id',
        'Total Number of Reopenings',
        'Mean',
        'Standard Deviation',
        'Median',
        'Minimum',
        'Maximum',
        '25th Percentile',
        '75th Percentile',
        '5th Percentile',
        '95th Percentile'
    ]

    return stats_df

# Usage
desc_stats = descriptive_stats(deltas_explode)
print(desc_stats)


print(df['Event_Type'].unique())


reopenings = df[df['Event_Type'].str.contains('IP-Level Ticket Reopened', case=False, na=False)]
