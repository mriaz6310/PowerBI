import pandas as pd

def descriptive_stats_per_ticket(df):
    # Filter reopenings
    reopenings = df[df['Event_Type'] == 'IP-Level Ticket Reopened']
    
    # Group by ticket ID
    grouped = reopenings.groupby('unique_ip_ticket_id')['Reopen_Deltas_int']
    
    # Calculate statistics
    stats_df = grouped.agg([
        'count',                      # Number of reopenings
        'mean',                       # Mean
        'std',                        # Standard Deviation
        'median',                     # Median
        'min',                        # Minimum
        'max',                        # Maximum
        lambda x: x.quantile(0.25),   # 25th Percentile
        lambda x: x.quantile(0.75),   # 75th Percentile
        lambda x: x.quantile(0.05),   # 5th Percentile
        lambda x: x.quantile(0.95)    # 95th Percentile
    ]).reset_index()
    
    # Rename columns
    stats_df.columns = [
        'unique_ip_ticket_id',
        'Total Number of Reopenings',
        'Mean',
        'Standard Deviation',
        'Median',
        'Minimum',
        'Maximum',
        '25th Percentile',
        '75th Percentile',
        '5th Percentile',
        '95th Percentile'
    ]
    
    return stats_df

# Usage
stats_per_ticket = descriptive_stats_per_ticket(deltas_explode)
print(stats_per_ticket)
