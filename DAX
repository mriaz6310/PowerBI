SELECT 
  'GRANT "' || pg_get_userbyid(roleid) || '" TO "' || pg_get_userbyid(member) || '";'
FROM pg_auth_members
WHERE pg_get_userbyid(roleid) NOT IN ('postgres', 'rdsadmin', 'rdsproxy')
  AND pg_get_userbyid(member) NOT IN ('postgres', 'rdsadmin', 'rdsproxy')
ORDER BY 1;


SELECT 
  'GRANT ' || privilege_type || ' ON "' || table_schema || '"."' || table_name || '" TO "' || grantee || '";'
FROM information_schema.role_table_grants
WHERE grantee NOT IN ('postgres', 'rdsadmin', 'rdsproxy')
ORDER BY grantee, table_schema, table_name;



SELECT 
  'GRANT USAGE ON SCHEMA "' || n.nspname || '" TO "' || r.rolname || '";'
FROM pg_roles r
CROSS JOIN pg_namespace n
WHERE n.nspname NOT LIKE 'pg_%'
  AND n.nspname <> 'information_schema'
  AND r.rolname NOT IN ('postgres', 'rdsadmin', 'rdsproxy')
ORDER BY 1;


SELECT 
  n.nspname AS schema_name,
  'postgrestestadm' AS grantee,
  has_schema_privilege('postgrestestadm', n.nspname, 'USAGE') AS has_usage,
  has_schema_privilege('postgrestestadm', n.nspname, 'CREATE') AS has_create
FROM pg_namespace n
WHERE n.nspname NOT LIKE 'pg_%'
  AND n.nspname <> 'information_schema'
ORDER BY n.nspname;





SELECT
    tablespace_name,
    ROUND(SUM(bytes) / 1024 / 1024 / 1024, 2) AS size_gb
FROM
    dba_segments
GROUP BY
    tablespace_name
ORDER BY
    size_gb DESC;



expdp 'admin/YourPasswordHere@//my-oracle-db.abcd1234.us-gov-west-1.rds.amazonaws.com:1521/ORCL' \
    directory=DATA_PUMP_DIR \
    dumpfile=my_export_%U.dmp \
    logfile=my_export.log \
    filesize=2G \
    parallel=2 \
    full=y


expdp 'admin/YourPasswordHere@//my-oracle-db.abcd1234.us-gov-west-1.rds.amazonaws.com:1521/ORCL' directory=DATA_PUMP_DIR dumpfile=my_export_%U.dmp logfile=my_export.log filesize=2G parallel=2 full=y



