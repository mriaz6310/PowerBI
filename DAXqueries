# Define parameters
$PGHOST = "your-hostname"
$PGPORT = "5432"
$PGUSER = "your-username"
$BACKUP_PATH = "C:\pg_dumps"
$RolesDumpFile = "$BACKUP_PATH\users_roles.sql"

# Ensure backup directory exists
if (!(Test-Path -Path $BACKUP_PATH)) {
    New-Item -ItemType Directory -Path $BACKUP_PATH | Out-Null
}

# Dump all users and roles
Write-Output "Starting dump of all users and roles..."
$DumpAllCommand = "pg_dumpall -h $PGHOST -p $PGPORT -U $PGUSER --roles-only > `"$RolesDumpFile`""
Invoke-Expression $DumpAllCommand

Write-Output "Users and roles dump completed at $RolesDumpFile."
